function l({wire:e,dropAllowed:i}){if(e)return{kanbanBoardWrapper:null,kanbanBoardContainer:null,kanbanBoardScrollY:0,kanbanTopSpace:0,kanbanColumns:null,minimapScrollLeft:0,minimapMaxScroll:0,minimapThumbWidth:null,init(){this.$nextTick(()=>{this.setupSortables()})},setupSortables(){if(this.kanbanBoardWrapper=this.$refs.kanbanBoardWrapper,this.kanbanBoardContainer=this.$refs.kanbanBoardContainer,this.calculateKanbanTopSpace(),this.updateMinimapMaxScroll(),this.kanbanColumns=document.querySelectorAll("[data-kanban-column]"),!this.kanbanColumns)return!1;this.kanbanColumns.forEach(a=>{this.resetColumnSortable(a),a.sortable=new Sortable(a,{group:{name:"kanban",pull:"clone"},animation:150,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",filter:".locked",...this.autoScrollOptions,onStart:t=>{t.item.setAttribute("data-original-index",t.oldIndex)},onMove:t=>{let n=t.from.dataset.status,o=t.to.dataset.status;this.clearVisualFeedback(),this.isMoveAllowed(n,o)||t.to.closest(".kanban-column").classList.add("drag-over-denied")},onEnd:t=>{let n=t.from.dataset.status,o=t.to.dataset.status,r=t.item.dataset.recordId;this.clearVisualFeedback(),this.isMoveAllowed(n,o)?e.moveRecord(r,o):this.returnToOriginal(t),t.item.removeAttribute("data-original-index")}})})},get autoScrollOptions(){return{scroll:this.$refs.kanbanBoardContainer??!0,forceAutoScrollFallback:!1,scrollSensitivity:100,scrollSpeed:20,bubbleScroll:!0}},resetColumnSortable(a){a.sortable&&a.sortable.destroy()},isMoveAllowed(a,t){if(a===t)return!0;let n=JSON.parse(i);return!n||typeof n!="object"?!0:!n[a]||n[a]?.includes(t)},returnToOriginal(a){a.item.remove();let t=a.item.getAttribute("data-original-index");if(t!==void 0){let n=a.from.children[t];n&&n!==a.item?a.from.replaceChild(a.item,n):n||a.from.appendChild(a.item)}},clearVisualFeedback(){this.kanbanColumns.forEach(a=>{let t=a.closest(".kanban-column");t&&t.classList.remove("drag-over-denied")})},calculateKanbanTopSpace(){this.kanbanTopSpace=(this.kanbanBoardWrapper?.offsetTop||0)+10},updateMinimapMaxScroll(){if(!this.kanbanBoardContainer)return;let a=this.kanbanBoardContainer;this.minimapMaxScroll=a.scrollWidth-a.clientWidth||0,this.minimapScrollLeft=a.scrollLeft,this.calculateMinimapThumbWidth()},onMinimapSliderInput(){this.kanbanBoardContainer.scrollLeft=this.minimapScrollLeft},calculateMinimapThumbWidth(){let{clientWidth:a,scrollWidth:t}=this.kanbanBoardContainer,n=a/t*(this.$refs.minimapRef?.clientWidth||0);this.minimapThumbWidth=(n||48)+"px"},onKanbanBoardScroll(){this.minimapScrollLeft=this.kanbanBoardContainer.scrollLeft,this.kanbanBoardScrollY=this.kanbanBoardContainer.scrollTop}}}export{l as kanbanBoard};
